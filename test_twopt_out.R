require(onemap)
require(Rcpp)
data(example.out)
x<-rf.2pts(example.out,verbose = FALSE)
s<-example.out$segr.type
names(s)<-colnames(example.out$geno)

##----------------------------------------------------------------------------------------------------------------------
##----------------------------------------------------------------------------------------------------------------------
##M1  M2  M3  M4  M5  M6  M7  M8  M9 M10 M11 M12 M13 M14 M15 M16 M17 M18 M19 M20 M21 M22 M23 M24 M25 M26 M27 M28 M29 M30 
##4   7   6   1   7   4   7   4   6   7   7   1   5   1   1   7   3   1   2   1   7   6   5   4   3   1   6   1   6   4 
##----------------------------------------------------------------------------------------------------------------------
##----------------------------------------------------------------------------------------------------------------------

sourceCpp("twopt_est_out_update.cpp")
y<-est_rf_out_new(x=example.out$geno, segreg_type = example.out$segr.type.num, n = example.out$n.ind)
a<-print(x, mrk1="M19", mrk2 = "M22")
(b<-t(sapply(y, function(x) c(x[19,22], x[22,19]))))
round(a-b,5)
